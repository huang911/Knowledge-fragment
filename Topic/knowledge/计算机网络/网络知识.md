| OSI七层体系结构 | TCP/IP四层体系结构        | 五层原理体系结构 |
| --------------- | ------------------------- | ---------------- |
| 7：应用层       | 应用层（HTTP，FTP, SMTP） | 应用层           |
| 6：表示层       | 运输层(TCP,UDP)           | 运输层           |
| 5：会话层       | 网际层IP                  | 网络层           |
| 4：运输层       | 网络接口层                | 数据链路层       |
| 3：网络层       |                           | 物理层           |
| 2：数据链路层   |                           |                  |
| 1：物理层       |                           |                  |

1.TCP连接建立

TCP的连接建立，主要解决：

(1).要使每一方都能够确知对方的存在；

(2).要允许双方协商一些参数（如最大报文段长度，最大窗口大学，服务质量）

(3).能够对运输实体资源（如缓存大小，各状态变量，连接表中的项目）进行分配和初始化。

过程：

a.客户端发出连接请求，置同步位（同步序列编号，**Synchronize Sequence Numbers**）SYN=1，序号seq=x;

b.服务端接受请求，并发出连接确认，置SYN=1，ACK（确认位，**Acknowledge character**）=1，序号seq=y,确认号ack=x+1;

c.客户端连接确认，置ACK=1，seq=x+1, 确认号ack=y+1;

客户端发送一个包含SYN标志的数据包，其后服务器返回一个SYN/ACK的应答包，表示客户端的请求被接受，最后客户端再返回一个确认包ACK，这样才完成TCP连接。

![1584192066677](C:\Users\qi\AppData\Roaming\Typora\typora-user-images\1584192066677.png)

2.TCP连接释放

a.主机A发出关闭连接请求的数据包，置结束标志位FIN=1，序号seq=u(表示不再发送数据，可以发送确认)；

b.主机B收到关闭连接请求，发出关闭连接确认，置确认位ACK=1，序号seq=v,确认号ack=u+1(半关闭状态)；

c.主机B发送数据，置结束标志位FIN=1，确认位ACK=1，序号seq=v,确认号ack=u+1;(B发送数据)；

d.关闭连接确认，等待关闭。置确认位ACK=1，序号seq=u+1，确认号ack=v+1;（关闭状态）

![1584191975422](C:\Users\qi\AppData\Roaming\Typora\typora-user-images\1584191975422.png)

| 状态码 | 含义                                                         |
| ------ | ------------------------------------------------------------ |
| 1XX    | 信息响应（服务器已经接受到请求，客户端可继续发送请求）       |
| 2XX    | 成功响应                                                     |
| 3XX    | （重定向）需要客户端采取进一步的操作才能完成请求，后续的请求地址（重定向目标）在本次响应的location域中指明。 |
| 4XX    | 客户端响应                                                   |
| 5XX    | 服务器错误                                                   |

